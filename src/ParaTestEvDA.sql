DROP TABLE RESPUESTA;
DROP TABLE EVALUACION;
DROP TABLE PUNTO_EVALUACION;
DROP TABLE PLANTILLA;
DROP TABLE ESTADO_EVALUACION;
DROP TABLE USUARIO;
DROP TABLE ROL;

CREATE TABLE ROL (
    ID_ROL      int NOT NULL, 
    DESCRIPCION varchar(50) NOT NULL, 
    PRIMARY KEY (ID_ROL)
);

CREATE TABLE ESTADO_EVALUACION (
    ID_ESTADO_EVALUACION int NOT NULL, 
    DESCRIPCION          varchar(50) NOT NULL, 
    PRIMARY KEY (ID_ESTADO_EVALUACION)
);

CREATE TABLE USUARIO (
    ID_USUARIO         int NOT NULL AUTO_INCREMENT, 
    NOMBRE             varchar(100) NOT NULL, 
    NOMBRE_USUARIO     varchar(100) NOT NULL, 
    CLAVE              varchar(16) NOT NULL, 
    ID_SUPERVISOR      int, 
    ID_USUARIO_CREADOR int NOT NULL, 
    ID_ROL             int NOT NULL, 
    PRIMARY KEY (ID_USUARIO),

    FOREIGN KEY (ID_SUPERVISOR) REFERENCES USUARIO (ID_USUARIO),
    FOREIGN KEY (ID_USUARIO_CREADOR) REFERENCES USUARIO (ID_USUARIO),
    FOREIGN KEY (ID_ROL) REFERENCES ROL (ID_ROL)
);

CREATE TABLE PLANTILLA (
    ID_PLANTILLA       int NOT NULL AUTO_INCREMENT, 
    FECHA_CREADA       date NOT NULL, 
    ID_USUARIO_CREADOR int NOT NULL, 
    PRIMARY KEY (ID_PLANTILLA),

    FOREIGN KEY (ID_USUARIO_CREADOR) REFERENCES USUARIO (ID_USUARIO)
);

CREATE TABLE PUNTO_EVALUACION (
    ID_PUNTO_EVALUACION int NOT NULL, 
    ID_PLANTILLA        int NOT NULL, 
    DESCRIPCION         varchar(500) NOT NULL, 
    PRIMARY KEY (ID_PUNTO_EVALUACION, ID_PLANTILLA),

    FOREIGN KEY (ID_PLANTILLA) REFERENCES PLANTILLA (ID_PLANTILLA)
);
CREATE TABLE EVALUACION (
    ID_EVALUACION        int NOT NULL AUTO_INCREMENT, 
    ID_PLANTILLA         int NOT NULL, 
    FECHA_CREADA         date NOT NULL, 
    ID_SUPERVISOR        int NOT NULL, 
    ID_REPRESENTANTE     int NOT NULL, 
    ID_ESTADO_EVALUACION int NOT NULL, 
    PRIMARY KEY (ID_EVALUACION, ID_PLANTILLA),

    FOREIGN KEY (ID_SUPERVISOR) REFERENCES USUARIO (ID_USUARIO),
    FOREIGN KEY (ID_REPRESENTANTE) REFERENCES USUARIO (ID_USUARIO),
    FOREIGN KEY (ID_PLANTILLA) REFERENCES PLANTILLA (ID_PLANTILLA),
    FOREIGN KEY (ID_ESTADO_EVALUACION) REFERENCES ESTADO_EVALUACION (ID_ESTADO_EVALUACION)
);
CREATE TABLE RESPUESTA (
    ID_EVALUACION       int NOT NULL, 
    ID_PUNTO_EVALUACION int NOT NULL, 
    ID_PLANTILLA        int NOT NULL, 
    CUMPLE_PUNTO        int NOT NULL, 
    ES_RECLAMADA        int DEFAULT 0 NOT NULL, 
    COMENTARIO          varchar(500), 
    PRIMARY KEY (ID_EVALUACION, ID_PUNTO_EVALUACION, ID_PLANTILLA),
    FOREIGN KEY (ID_EVALUACION, ID_PLANTILLA) REFERENCES EVALUACION (ID_EVALUACION, ID_PLANTILLA),
    FOREIGN KEY (ID_PLANTILLA, ID_PUNTO_EVALUACION) REFERENCES PUNTO_EVALUACION (ID_PLANTILLA, ID_PUNTO_EVALUACION)
);

INSERT INTO ROL (ID_ROL, DESCRIPCION) VALUES (1, 'Administrador');
INSERT INTO ROL (ID_ROL, DESCRIPCION) VALUES (2, 'Supervisor');
INSERT INTO ROL (ID_ROL, DESCRIPCION) VALUES (3, 'Representante');

-- USUARIO
INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Aneudy Labour', 'alabour', '1234', 1, 1);

INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Pablo primero', 'pprimero', '1234', 1, 2);

INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Pablo segundo', 'psegundo', '1234', 1, 2);
	
INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_SUPERVISOR, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Pablo tercero', 'ptercero', '1234', 2, 1, 3);

INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_SUPERVISOR, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Pablo cuarto', 'pcuarto', '1234', 2, 1, 3);

INSERT INTO USUARIO
	(NOMBRE, NOMBRE_USUARIO, CLAVE, ID_SUPERVISOR, ID_USUARIO_CREADOR, ID_ROL)
VALUES
	('Pablo quinto', 'pquinto', '1234', 3, 1, 3);
	
-- ESTADO_EVALUACION
INSERT INTO ESTADO_EVALUACION (ID_ESTADO_EVALUACION, DESCRIPCION) VALUES (1, 'Pendiente');
INSERT INTO ESTADO_EVALUACION (ID_ESTADO_EVALUACION, DESCRIPCION) VALUES (2, 'Reclamada');
INSERT INTO ESTADO_EVALUACION (ID_ESTADO_EVALUACION, DESCRIPCION) VALUES (3, 'Finalizada');

-- PLANTILLA
INSERT INTO PLANTILLA (FECHA_CREADA, ID_USUARIO_CREADOR) VALUES ('2013-07-02', 1);

-- PUNTO_EVALUACION
INSERT INTO PUNTO_EVALUACION (ID_PUNTO_EVALUACION, ID_PLANTILLA, DESCRIPCION) VALUES (1,1, 'El representante utiliza protocolo de bienvenida');
INSERT INTO PUNTO_EVALUACION (ID_PUNTO_EVALUACION, ID_PLANTILLA, DESCRIPCION) VALUES (2,1, 'El representante muestra empatía durante la conversación');
INSERT INTO PUNTO_EVALUACION (ID_PUNTO_EVALUACION, ID_PLANTILLA, DESCRIPCION) VALUES (3,1, 'El representante identifica la necesidad del cliente');

-- EVALUACION
INSERT INTO EVALUACION (FECHA_CREADA, ID_ESTADO_EVALUACION, ID_PLANTILLA, ID_REPRESENTANTE, ID_SUPERVISOR) VALUES ('2013-04-07', 1, 1, 4, 2);

-- RESPUESTA
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (1, 1, 1, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (1, 1, 2, 0);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (1, 1, 3, 1);


INSERT INTO EVALUACION (FECHA_CREADA, ID_ESTADO_EVALUACION, ID_PLANTILLA, ID_REPRESENTANTE, ID_SUPERVISOR) VALUES ('2013-11-12', 1, 1, 4, 2);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (2, 1, 1, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (2, 1, 2, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (2, 1, 3, 1);

INSERT INTO EVALUACION (FECHA_CREADA, ID_ESTADO_EVALUACION, ID_PLANTILLA, ID_REPRESENTANTE, ID_SUPERVISOR) VALUES ('2013-11-12', 1, 1, 4, 2);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (3, 1, 1, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (3, 1, 2, 0);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (3, 1, 3, 0);


INSERT INTO EVALUACION (FECHA_CREADA, ID_ESTADO_EVALUACION, ID_PLANTILLA, ID_REPRESENTANTE, ID_SUPERVISOR) VALUES ('2013-11-12', 1, 1, 5, 2);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (4, 1, 1, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (4, 1, 2, 0);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (4, 1, 3, 1);

INSERT INTO EVALUACION (FECHA_CREADA, ID_ESTADO_EVALUACION, ID_PLANTILLA, ID_REPRESENTANTE, ID_SUPERVISOR) VALUES ('2013-11-12', 1, 1, 5, 2);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (5, 1, 1, 1);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (5, 1, 2, 0);
INSERT INTO RESPUESTA (ID_EVALUACION, ID_PLANTILLA, ID_PUNTO_EVALUACION, CUMPLE_PUNTO) VALUES (5, 1, 3, 1);

